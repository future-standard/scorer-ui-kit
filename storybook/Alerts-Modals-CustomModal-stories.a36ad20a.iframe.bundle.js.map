{"version":3,"file":"Alerts-Modals-CustomModal-stories.a36ad20a.iframe.bundle.js","mappings":";;;;;;;AAoBA;;;;;AAOA;AACA;AACA;;;;AAIA;AAqFA","sources":["webpack://scorer-ui-kit-storybook/./src/stories/Alerts/Modals/LoginModalExample.tsx"],"sourcesContent":["import React, {useCallback, ChangeEvent, useState } from 'react';\nimport styled, {css} from 'styled-components';\nimport {\n  ButtonWithLoading,\n  TextField,\n  PasswordField,\n  AlertBar,\n  Form,\n  useModal,\n} from 'scorer-ui-kit';\n\nconst Container = styled.div``;\n\nconst Title = styled.div`\n  font-size: 20px;\n  font-weight: 500;\n  text-align: center;\n  color: var(--grey-11);\n  position:relative;\n  margin-bottom: 45px;\n`;\n\nconst Box = styled.div<{ margin?: string; flex?: string; }>`\n  margin-top:30px;\n  button{\n    width: 100%;\n  }\n  ${({ margin }) => margin && css`margin:${margin};`}\n  ${({ flex }) => flex && css`\n    flex:${flex};\n    justify-content: flex-end;\n    display: flex;\n    flex-direction: column;\n  `}\n`;\n\ninterface Alert {\n  type: 'error'|'warning'|'info'|'success';\n  message: string;\n}\n\nconst LoginModalExample : React.FC = () => {\n  const [loading, setLoading] = useState(false);\n  const [alert, setAlert] = useState<Alert | null>(null);\n  const [form, setForm] = useState({ username: '', password: '' });\n  const onFieldChange = useCallback(\n    (key: 'username' | 'password') => ({ target: { value } }: ChangeEvent<HTMLInputElement>) => {\n      setForm({ ...form, [key]: value });\n    }, [form]);\n\n  const { setModalOpen } = useModal();\n\n  // Fake login for the example\n  const onLogin = useCallback((params: { username: string; password: string })  => {\n    if(params.username === 'user' && params.password === 'fakepass123') {\n      return true;\n    }\n    throw Error(`The username: ${params.username}  and password provided does not match`)\n  },[]);\n\n  const onSubmit = useCallback(async (params: { username: string; password: string }) => {\n    let isSuccess = false;\n    setLoading(true);\n    setAlert(null);\n    try {\n      const response = await onLogin(params);\n      console.log(response, 'login');\n      isSuccess = true;\n    } catch (error) {\n      if(error instanceof Error) {\n        console.log(`got error: ${error.message}`);\n        setAlert({\n          message: error.message,\n          type: 'error'\n        });\n      } else {\n        console.warn(error);\n      }\n    }\n    setLoading(false);\n    return isSuccess;\n  }, [onLogin]);\n\n  const validateFields = (params: { username: string; password: string }) => {\n    if(params.username === '') {\n      setAlert({\n        message: 'User should not be empty',\n        type: 'error'\n      });\n      return false;\n    }\n\n    if(params.password === '') {\n      setAlert({\n        message: 'Password should not be empty',\n        type: 'error'\n      });\n      return false;\n    }\n\n    return true;\n  };\n\n  const handleModalSubmit = useCallback(async (e: React.FormEvent<HTMLFormElement | HTMLButtonElement>) => {\n    e.preventDefault();\n\n    // Validate inputs and show errors\n    const areInputsValid = validateFields(form);\n\n    // if inputs are not valid return to allow user to correct before submiting\n    if(!areInputsValid) { return; }\n\n    const loginSuccess = await onSubmit(form);\n\n    // if there was a login error return to allow user to correct and retry\n    if(!loginSuccess) {return;}\n\n    // if there were no errors close modal\n    setModalOpen(false);\n\n  },[onSubmit, setModalOpen, form]);\n\n\n  return(\n    <Container>\n    <Form onSubmit={handleModalSubmit}>\n    <Title>Sign In To Your Account</Title>\n    <TextField\n      fieldState='default'\n      required\n      label='Username'\n      onChange={onFieldChange('username')}\n      value={form.username}\n      name='username'\n      id='username'\n    />\n    <PasswordField\n      fieldState='default'\n      required\n      label='Password'\n      onChange={onFieldChange('password')}\n      value={form.password}\n      name='password'\n      id='password'\n    />\n    {alert && <AlertBar type={alert.type} message={alert.message} />}\n    <Box flex='1'>\n      <ButtonWithLoading loading={loading} type='submit' onClick={handleModalSubmit}>Login</ButtonWithLoading>\n    </Box>\n  </Form>\n    </Container>\n  );\n}\n\nexport default LoginModalExample;"],"names":[],"sourceRoot":""}